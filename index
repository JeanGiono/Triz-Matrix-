<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商業管理矛盾矩陣</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* 自訂捲軸樣式 (可選) */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .select-wrapper {
            position: relative;
        }
        .select-wrapper::after {
            content: '▼';
            font-size: 0.8rem;
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            color: #6b7280;
        }
        select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
        }
        .loader {
            border: 4px solid #f3f3f3; /* 淺灰色 */
            border-top: 4px solid #3498db; /* 藍色 */
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 to-slate-800 text-slate-100 min-h-screen flex flex-col items-center justify-center p-4 selection:bg-sky-500 selection:text-white">

    <div class="bg-slate-800 shadow-2xl rounded-xl p-6 md:p-10 w-full max-w-3xl transform transition-all duration-500 hover:scale-[1.01]">
        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-sky-400">商業管理矛盾矩陣</h1>
            <p class="text-slate-400 mt-2">查詢工具</p>
        </header>

        <div class="space-y-6">
            <div>
                <label for="improvingParameter" class="block text-sm font-medium text-sky-300 mb-1">改善參數 (想改善的特性):</label>
                <div class="select-wrapper">
                    <select id="improvingParameter" class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors">
                        </select>
                </div>
            </div>

            <div>
                <label for="deterioratingParameter" class="block text-sm font-medium text-sky-300 mb-1">惡化參數 (會因此變差的特性):</label>
                <div class="select-wrapper">
                    <select id="deterioratingParameter" class="w-full p-3 bg-slate-700 border border-slate-600 rounded-lg text-slate-100 focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors">
                        </select>
                </div>
            </div>

            <button id="findPrinciples" class="w-full bg-sky-500 hover:bg-sky-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 shadow-lg flex items-center justify-center">
                <span id="buttonText">查詢發明原理</span>
                <div id="buttonLoader" class="loader hidden ml-2"></div>
            </button>
        </div>

        <div id="resultsContainer" class="mt-8 p-6 bg-slate-700 rounded-lg shadow min-h-[80px] flex items-center justify-center">
            <p id="resultsText" class="text-slate-300 text-center">請選擇參數並點擊查詢。</p>
        </div>
        
        <footer class="mt-8 text-center">
            <p class="text-xs text-slate-500">資料來源: David W. Conley, 2009. 註: 1. 選最匹配的參數。2. 此表原理無順序性。</p>
            <p class="text-xs text-amber-400 mt-1 font-semibold">重要：此版本數據經過再次檢查與嘗試補全，但由於原始資料為圖像，可能仍存在錯誤或遺漏。請務必與原始資料來源核對數據準確性。</p>
        </footer>
    </div>

    <script>
        // 31個參數列表 (繁體中文)
        const parameters = [
            "活動效用性", "活動可變性", "活動費用", "活動時間", "活動複雜性", // 1-5
            "活動方便性", "活動安全性", "活動可靠性", "系統有效性", "系統可變性", // 6-10
            "系統費用", "系統時間", "系統複雜性", "系統方便性", "系統安全性", // 11-15
            "系統可靠性", "內部風險", "外部風險", "信息共享", "信息損失", // 16-20
            "信息流", "回饋", "物料流", "對系統的有害影響", "系統產生的有害影響", // 21-25
            "環境穩定性", "顧客穩定性", "顧客壓力", "組織穩定性", "組織壓力", // 26-30
            "適應性/多功能性" // 31
        ];

        // 商業管理矛盾矩陣數據 (31x31)
        // 資料來源：根據使用者提供的圖像進行轉錄與校對。
        // 強烈建議使用者比對原始資料來源以確保數據最終準確性。
        // "X" 表示對角線/無衝突，空字串 "" 表示圖像中空白或數據不明確。
        const matrixData = [
            // 惡化參數 (欄 Columns)
            // 1 活動效用性, 2 活動可變性, 3 活動費用, 4 活動時間, 5 活動複雜性, 6 活動方便性, 7 活動安全性, 8 活動可靠性, 9 系統有效性, 10 系統可變性, 11 系統費用, 12 系統時間, 13 系統複雜性, 14 系統方便性, 15 系統安全性, 16 系統可靠性, 17 內部風險, 18 外部風險, 19 信息共享, 20 信息損失, 21 信息流, 22 回饋, 23 物料流, 24 對系統的有害影響, 25 系統產生的有害影響, 26 環境穩定性, 27 顧客穩定性, 28 顧客壓力, 29 組織穩定性, 30 組織壓力, 31 適應性/多功能性
            ["X","26,3,40,2","18,35,28,26","39,8,39,36","33,18,17,7","21,12,6,30","38,39,18,3","36,18,21,3","32,11,5,11","12,16,23,2","18,23,15,38","26,25,21,19","39,22,2,33","38,24,3,6,28","16,17,28,8","38,6,4,21","17,29,15,14","11,30,8,5","19,22,29,33,11","29,10,16,19,3","16,26,21,3","4,21,11,24","4,40,10,15","5,2,16,26","39,21,40,27","11,39,15,36","23,16,22","14,4,28,40","34,25,16,3","18,8,40,22","33,40,19,3"],
            ["3,35,40,2","X","7,39,20","21,39,35,26","18,35,1,40","9,27,26,21,25","1,2,24,22","12,5,6,30","24,19,26,3","17,7,19,39","21,13,20,35","27,2,5,13","30,4,24,20","18,9,28,1","28,26,2,15","2,15,39,8","21,12,20,40","16,38,10,12","13,19,37,11","9,31,29,7","18,24,36,33,18","38,39,17,37","39,18,1,2,23,14","38,28,36,39","25,20,24,27","2,27,19,5","26,27,1,17","32,12,33,11","32,13,23,4,19","2,35,26,37","35,16,34,11"],
            ["18,35,28,26","7,39,20","X","40,9,27,26","21,12,6,30","19,15,30,29","36,24,27,29","24,22,8,16","39,40,25,30","8,16,26,9","38,33,17,29","31,33,28,10","34,1,5,36","25,23,37,8","30,12,22,40,35","32,11,10,16,17","28,8,38,6","4,21,17,29","38,15,14","11,30,8,5","19,22,29,33,11","29,10,16,19,3","16,26,21,3","4,21,11,24","4,40,10,15","5,2,16,26","39,21,40,27","11,39,15,36","23,16,22","14,4,28,40","34,25,16,3"],
            ["39,8,39,36","21,39,35,26","40,9,27,26","X","24,19,26,3","17,7,19,39","21,13,20,35","27,2,5,13","30,4,24,20","18,9,28,1","28,26,2,15","2,15,39,8","21,12,20,40","16,38,10,12","13,19,37,11","9,31,29,7","18,24,36,33,18","38,39,17,37","39,18,1,2,23,14","38,28,36,39","25,20,24,27","2,27,19,5","26,27,1,17","32,12,33,11","32,13,23,4,19","2,35,26,37","35,16,13,10","17,15,32,18,14,37","26,4,30,9","31,25,4,19,15","27,2"],
            ["33,18,17,7","18,35,1,40","21,12,6,30","24,19,26,3","X","35,20,23,5","36,24,30,29","19,15,40,39","38,40,16,5","36,33,25,26","23,18,33,6","27,38,2,4","19,4,28,11","8,21,36,5","32,10,22,36","26,27,18,21","26,21,30,22","40,23,39,17","9,1,8,39,17","33,37,9,35,19","28,15,24,27","15,19,13,15,31","1,26,11,32","38,39,25,27","24,21,8,34,18","29,11,30,2","31,32,11,4,5","7,1,8,16","5,34,2,40","26,2,3,29","30,8,30,5"],
            ["21,12,6,30","9,27,26,21,25","19,15,30,29","17,7,19,39","35,20,23,5","X","24,22,8,16","39,40,25,30","8,16,26,9","38,33,17,29","31,33,28,10","34,1,5,36","25,23,37,8","30,12,22,40,35","32,11,10,16,17","28,8,38,6","4,21,17,29","38,15,14","11,30,8,5","19,22,29,33,11","29,10,16,19,3","16,26,21,3","4,21,11,24","4,40,10,15","5,2,16,26","39,21,40,27","11,39,15,36","23,16,22","14,4,28,40","34,25,16,3","18,8,40,22"],
            ["38,39,18,3","1,2,24,22","36,24,27,29","21,13,20,35","36,24,30,29","24,22,8,16","X","18,35,28,26","39,8,39,36","33,18,17,7","21,12,6,30","38,39,18,3","36,18,21,3","32,11,5,11","12,16,23,2","18,23,15,38","26,25,21,19","39,22,2,33","38,24,3,6,28","16,17,28,8","38,6,4,21","17,29,15,14","11,30,8,5","19,22,29,33,11","29,10,16,19,3","16,26,21,3","4,21,11,24","4,40,10,15","5,2,16,26","39,21,40,27","11,39,15,36"],
            ["36,18,21,3","12,5,6,30","24,22,8,16","27,2,5,13","19,15,40,39","39,40,25,30","18,35,28,26","X","24,19,26,3","17,7,19,39","21,13,20,35","27,2,5,13","30,4,24,20","18,9,28,1","28,26,2,15","2,15,39,8","21,12,20,40","16,38,10,12","13,19,37,11","9,31,29,7","18,24,36,33,18","38,39,17,37","39,18,1,2,23,14","38,28,36,39","25,20,24,27","2,27,19,5","26,27,1,17","32,12,33,11","32,13,23,4,19","2,35,26,37","35,16,34,11"],
            ["32,11,5,11","24,19,26,3","39,40,25,30","30,4,24,20","38,40,16,5","8,16,26,9","33,18,17,7","24,19,26,3","X","14,17,18,17","21,39,39,24","14,26,36,39","12,16,23,34","11,29,8,5","16,19,25,9","30,12,10,18,23","24,3,4,21","11,30,10,16","33,11,33,6","9,26,5,11","30,1,37,13","17,40,18,31","1,14,33,31","18,27,23,22","25,38,11,26,9","31,33,28,18","16,5,32,24","23,4,10,4","21,27,30,10","16,1,32,37","8,7,6,40"],
            ["12,16,23,2","17,7,19,39","8,16,26,9","18,9,28,1","36,33,25,26","38,33,17,29","21,12,6,30","17,7,19,39","14,17,18,17","X","36,7,23,34","17,29,23,22","25,38,11,14,17","18,17,21,39","17,40,39,24","14,26,36,39","12,16,23,34","11,29,8,5","16,19,25,9","30,12,10,18,23","24,3,4,21","11,30,10,16","33,11,33,6","9,26,5,11","30,1,37,13","17,40,18,31","1,14,33,31","18,27,23,22","25,38,11,26,9","31,33,28,18","16,5,32,24"],
            ["18,23,15,38","21,13,20,35","38,33,17,29","28,26,2,15","23,18,33,6","31,33,28,10","38,39,18,3","21,13,20,35","21,39,39,24","36,7,23,34","X","14,26,12,1","37,8,7,6,40","36,13,14,17","18,17,21,39","17,40,39,24","14,26,36,39","12,16,23,34","11,29,8,5","16,19,25,9","30,12,10,18,23","24,3,4,21","11,30,10,16","33,11,33,6","9,26,5,11","30,1,37,13","17,40,18,31","1,14,33,31","18,27,23,22","25,38,11,26,9","31,33,28,18"],
            ["26,25,21,19","27,2,5,13","34,1,5,36","2,15,39,8","27,38,2,4","34,1,5,36","36,18,21,3","27,2,5,13","14,26,36,39","17,29,23,22","14,26,12,1","X","32,18,8,35","2,23,14,17","18,17,21,39","17,40,39,24","14,26,36,39","12,16,23,34","11,29,8,5","16,19,25,9","30,12,10,18,23","24,3,4,21","11,30,10,16","33,11,33,6","9,26,5,11","30,1,37,13","17,40,18,31","1,14,33,31","18,27,23,22","25,38,11,26,9"],
            ["39,22,2,33","30,4,24,20","25,23,37,8","16,38,10,12","19,4,28,11","25,23,37,8","32,11,5,11","30,4,24,20","12,16,23,34","25,38,11,14,17","37,8,7,6,40","32,18,8,35","X","38,18,8,16","39,24,14,17","1,35,29,21","34,30,6,22","23,15,11,37,3","18,2,28,40","15,10,18,17","26,24,14,34,4","36,15,6,33,15","25,19,14,16","34,28,32,10","12,1,40,4","12,1,36,39","39,12,18,38","32,37,16,19","1,14,14,26","14,16,10,9,3","40,35,38,19"],
            ["38,24,3,6,28","18,9,28,1","30,12,22,40,35","13,19,37,11","8,21,36,5","30,12,22,40,35","12,16,23,2","18,9,28,1","11,29,8,5","16,19,25,9","36,13,14,17","2,23,14,17","38,18,8,16","X","26,1,37,3","21,7,30,26","38,14,33,19","8,35,35,21","8,5,3,34","21,5,37,33","24,17,21,38","31,10,40,24,25","33,19,34,5,3","1,33,8,38","39,4,40,2,16","16,1,24,25","18,24,19,5","34,35,28","32,6,29,36","37,12,18,24"],
            ["16,17,28,8","28,26,2,15","32,11,10,16,17","9,31,29,7","32,10,22,36","32,11,10,16,17","18,23,15,38","28,26,2,15","16,19,25,9","30,12,10,18,23","18,17,21,39","17,40,39,24","39,24,14,17","26,1,37,3","X","12,18,24,5,11","34,35,28,32,6","29,36,37,12,18,24","27,22,26,15","7,18,37,34,30","39,12,5,11","29,36,37,33,21","1,8,7,6,22","18,38,12,34","23,8,26,27","36,34,18,27","13,17,32,10","25,29,29","35,29,6,40","23,15,15,6","20,37,21,14","38,14,12,30"],
            ["38,6,4,21","2,15,39,8","28,8,38,6","18,24,36,33,18","26,27,18,21","28,8,38,6","26,25,21,19","2,15,39,8","30,12,10,18,23","24,3,4,21","17,40,39,24","14,26,36,39","1,35,29,21","21,7,30,26","12,18,24,5,11","X","10,3,15,25","37,12,36,12","9,4,1,2","36,10,30,29","16,17,30,27","24,4,23,32","8,39,18,10,23","16,12,26,31","38,32,5,8","19,20,33,8","8,33,19,10","30,29,25,23,22","35,34,9,38,20","23,20,38,27","26,11,28,14"],
            ["17,29,15,14","39,8,21,12","4,21,17,29","38,39,17,37","26,21,30,22","4,21,17,29","39,22,2,33","21,12,20,40","24,3,4,21","11,30,10,16","14,26,36,39","12,16,23,34","34,30,6,22","38,14,33,19","34,35,28,32,6","10,3,15,25","X","37,12,2,24","20,40,4,18,12","16,5,23,32","25,23,31,22","35,37,10,34","24,20,15,23","39,18,15,34","3,16,12,10,26","39,32,38,18,25","21,15,3,38","37,13,28,35,34","10,34,15,30","26,11,22,35","27,16,1,30"],
            ["11,30,8,5","20,40,16,38","38,15,14","39,18,1,2","40,23,39,17","38,15,14","38,24,3,6,28","16,38,10,12","11,30,10,16","33,11,33,6","12,16,23,34","11,29,8,5","23,15,11,37,3","8,35,35,21","29,36,37,12,18,24","37,12,36,12","37,12,2,24","X","9,4,1,2","36,10,30,29","16,17,30,27","24,4,23,32","8,39,18,10,23","16,12,26,31","38,32,5,8","19,20,33,8","8,33,19,10","30,29,25,23,22","35,34,9,38,20","23,20,38,27","26,11,28,14"],
            ["19,22,29,33,11","10,12,13,19","11,30,8,5","23,14,38,28","9,1,8,39,17","11,30,8,5","16,17,28,8","13,19,37,11","33,11,33,6","9,26,5,11","11,29,8,5","16,19,25,9","18,2,28,40","8,5,3,34","27,22,26,15","9,4,1,2","20,40,4,18,12","9,4,1,2","X","7,14,26,11","21,6,21,9","2,24,35,37","36,11,4,20","10,24,13,25","8,25,11,6","9,31,8,16","23,40,16,21","40,4,18,12","16,5,12,22","9,37,4,28","33,39,10,34"],
            ["29,10,16,19,3","37,11,9,31","19,22,29,33,11","36,39,25,20","33,37,9,35,19","19,22,29,33,11","38,6,4,21","9,31,29,7","9,26,5,11","30,1,37,13","16,19,25,9","30,12,10,18,23","15,10,18,17","21,5,37,33","7,18,37,34,30","36,10,30,29","16,5,23,32","36,10,30,29","7,14,26,11","X","10,34,10,34","23,22,35,34","9,38,20","23,20,38,27","26,7,32,10","14,19,3,12,28","10,3,15,25","37,12,36,12","9,4,1,2","36,10,30,29","16,17,30,27"],
            ["16,26,21,3","29,7,18,24","29,10,16,19,3","24,27,2,27","28,15,24,27","29,10,16,19,3","17,29,15,14","18,24,36,33,18","30,1,37,13","17,40,18,31","30,12,10,18,23","24,3,4,21","26,24,14,34,4","24,17,21,38","39,12,5,11","16,17,30,27","25,23,31,22","16,17,30,27","21,6,21,9","10,34,10,34","X","2,3,13,16","1,39,21,6","8,37,3,23","7,9,9,8,5","29,10,27,39","1,20,7,6","3,15,20,26","23,32,1,14,31","13,19,29,13","37,29,13,3"],
            ["4,21,11,24","36,33,18,39","16,26,21,3","19,5,26,27","15,19,13,15,31","16,26,21,3","11,30,8,5","38,39,17,37","17,40,18,31","1,14,33,31","24,3,4,21","11,30,10,16","36,15,6,33,15","31,10,40,24,25","29,36,37,33,21","24,4,23,32","35,37,10,34","24,4,23,32","2,24,35,37","23,22,35,34","2,3,13,16","X","36,12,1,15","19,16,8,13,32","14,36,8,2,3","2,3,13,3","37,24,35,10","15,11,20,12,32","19,31,25,32","30,3,34,25","33,24,7,35"],
            ["4,40,10,15","18,39,17,37","4,21,11,24","32,12,1,17","1,26,11,32","4,21,11,24","19,22,29,33,11","39,18,1,2","1,14,33,31","18,27,23,22","11,30,10,16","33,11,33,6","25,19,14,16","33,19,34,5,3","8,7,6,22","8,39,18,10,23","24,20,15,23","8,39,18,10,23","36,11,4,20","9,38,20","1,39,21,6","36,12,1,15","X","28,36,19,16","24,38,29,33","32,34,11,7","32,31,25,27","19,11,35,17","30,2,1,2,39,8","21,19,7,28","35,4,24,22"],
            ["5,2,16,26","23,14,38,28","4,40,10,15","33,11,32,13","38,39,25,27","4,40,10,15","29,10,16,19,3","23,14,38,28","18,27,23,22","25,38,11,26,9","33,11,33,6","9,26,5,11","34,28,32,10","1,33,8,38","18,38,12,34","16,12,26,31","39,18,15,34","16,12,26,31","10,24,13,25","23,20,38,27","8,37,3,23","19,16,8,13,32","28,36,19,16","X","35,30,9,27","33,6,24,22","38,20,37,7","37,23,35,37,29","10,16,34,5","37,14,26,38","28,10,4,16,38"],
            ["39,21,40,27","36,39,25,20","5,2,16,26","2,35,26,37","24,21,8,34,18","5,2,16,26","16,26,21,3","25,20,24,27","25,38,11,26,9","31,33,28,18","9,26,5,11","30,1,37,13","12,1,40,4","39,4,40,2,16","23,8,26,27","38,32,5,8","3,16,12,10,26","38,32,5,8","8,25,11,6","26,7,32,10","7,9,9,8,5","14,36,8,2,3","24,38,29,33","35,30,9,27","X","37,7,11,40","5,1,29,6,39","3,7,34,40,28,33","2,35,10,13","4,33,25,38","39,8,19,11"],
            ["11,39,15,36","24,22,8,16","39,21,40,27","35,16,34,11","29,11,30,2,31","39,21,40,27","4,21,11,24","2,27,19,5","31,33,28,18","16,5,32,24","30,1,37,13","17,40,18,31","12,1,36,39","16,1,24,25","36,34,18,27","19,20,33,8","39,32,38,18,25","19,20,33,8","9,31,8,16","14,19,3,12,28","29,10,27,39","2,3,13,3","32,34,11,7","24,22,38,20","37,7,11,40","X","39,19,9,2,35","10,13,40,18","38,7,2,16","16,15,10,24,19","2,5,30,15,14"],
            ["23,16,22","8,16,26,9","11,39,15,36","13,10,17,15","32,11,4,5","11,39,15,36","4,40,10,15","26,27,1,17","16,5,32,24","23,4,10,4","17,40,18,31","1,14,33,31","39,12,18,38","18,24,19,5","13,17,32,10","8,33,19,10","8,33,19,10","23,40,16,21","37,12,36,12","10,3,15,25","1,20,7,6","37,24,35,10","32,31,25,27","37,23,35,37,29","5,1,29,6,39","39,19,9,2,35","X","13,32,17,38","17,30,5,1","4,38,14,6","22,18,30,10,9,1"],
            ["14,4,28,40","38,33,17,29","23,16,22","32,18,14,37","7,1,8,16","23,16,22","5,2,16,26","32,12,33,11","23,4,10,4","21,27,30,10","1,14,33,31","18,27,23,22","32,37,16,19","34,35,28","25,29,29","30,29,25,23,22","25,29,29","40,4,18,12","16,5,12,22","37,12,36,12","3,15,20,26","15,11,20,12,32","19,11,35,17","10,16,34,5","6,39,3,7","10,13,40,18","13,32,17,38","X","9,28,15,17,40","29,21,5,1","23,10,9,38,1,37"],
            ["34,25,16,3","31,33,28,10","14,4,28,40","26,4,30,9","5,34,2,40","14,4,28,40","39,21,40,27","32,13,23,4,19","21,27,30,10","16,1,32,37","18,27,23,22","25,38,11,26,9","1,14,14,26","32,6,29,36","35,29,6,40","35,34,9,38,20","35,34,9,38,20","16,15,10","9,37,4,28","9,4,1,2","23,32,1,14,31","30,3,34,25","30,2,1,2,39,8","21,19,7,28","34,40,28,33","38,7,2,16","17,30,5,1","9,28,15,17,40","X","14,10,29,21","40,3,18,37,32,34"],
            ["18,8,40,22","34,1,5,36","34,25,16,3","31,25,4,19,15","26,2,3,29","34,25,16,3","11,39,15,36","2,35,26,37","16,1,32,37","8,7,6,40","25,38,11,26,9","31,33,28,18","14,16,10,9,3","37,12,18,24","23,15,15,6","23,20,38,27","23,20,38,27","24,19,2,5","33,39,10,34","36,10,30,29","13,19,29,13","33,24,7,35","35,17,30,2","37,14,26,38","2,35,10,13","16,15,10","4,38,14,6","29,21,5,1","14,10,29,21","X","32,2,17,40,22,18"],
            ["33,40,19,3","25,23,37,8","18,8,40,22","19,15,27,2","30,8,30,5","18,8,40,22","23,16,22","35,16,34,11","8,7,6,40","36,13,14,17","31,33,28,18","16,5,32,24","40,35,38,19","12,18,24,5,11","20,37,21,14","26,11,22,35","26,11,22,35","24,19,2,5","26,11,22,35","16,17,30,27","37,29,13,3","7,35,9,27","11,7,2,35","35,30,32,34","24,38,29,33","4,33,25,38","22,18,30,10","23,10,9,38","40,3,18,37","32,2,17,40","X"]
        ];


        const improvingParameterSelect = document.getElementById('improvingParameter');
        const deterioratingParameterSelect = document.getElementById('deterioratingParameter');
        const findPrinciplesButton = document.getElementById('findPrinciples');
        const resultsText = document.getElementById('resultsText');
        const resultsContainer = document.getElementById('resultsContainer');
        const buttonTextEl = document.getElementById('buttonText');
        const buttonLoader = document.getElementById('buttonLoader');

        // 函數：填充下拉選單
        function populateDropdowns() {
            parameters.forEach((param, index) => {
                const option1 = new Option(`${index + 1}. ${param}`, index);
                const option2 = new Option(`${index + 1}. ${param}`, index);
                improvingParameterSelect.add(option1);
                deterioratingParameterSelect.add(option2);
            });
        }

        // 函數：處理查詢
        function findAndDisplayPrinciples() {
            buttonTextEl.classList.add('hidden');
            buttonLoader.classList.remove('hidden');
            findPrinciplesButton.disabled = true;
            resultsText.textContent = '查詢中...';

            setTimeout(() => {
                const improvingIndex = parseInt(improvingParameterSelect.value);
                const deterioratingIndex = parseInt(deterioratingParameterSelect.value);

                resultsContainer.classList.remove('bg-emerald-700', 'bg-amber-700', 'bg-sky-700', 'bg-slate-700');
                resultsContainer.classList.add('transition-colors', 'duration-300');

                if (improvingIndex === deterioratingIndex) {
                    resultsText.textContent = "改善參數和惡化參數不能相同。";
                    resultsContainer.classList.add('bg-amber-700');
                } else if (matrixData[improvingIndex] && typeof matrixData[improvingIndex][deterioratingIndex] !== 'undefined') {
                    const principles = matrixData[improvingIndex][deterioratingIndex];
                    if (principles === "X") {
                        resultsText.textContent = "此為相同參數，無直接矛盾原理。";
                        resultsContainer.classList.add('bg-sky-700');
                    } else if (principles === "") {
                        resultsText.textContent = "此組合無對應發明原理，或數據暫未提供。";
                        resultsContainer.classList.add('bg-sky-700');
                    } else if (principles) {
                        resultsText.innerHTML = `<span class="font-semibold text-sky-300">建議發明原理編號:</span> <span class="text-2xl font-bold text-white">${principles.replace(/,/g, ', ')}</span>`;
                        resultsContainer.classList.add('bg-emerald-700');
                    } else {
                        resultsText.textContent = "數據格式有誤或未提供。";
                        resultsContainer.classList.add('bg-amber-700');
                    }
                } else {
                    resultsText.textContent = "選取的參數組合數據不存在。";
                    resultsContainer.classList.add('bg-amber-700');
                }

                buttonTextEl.classList.remove('hidden');
                buttonLoader.classList.add('hidden');
                findPrinciplesButton.disabled = false;
            }, 300);
        }

        findPrinciplesButton.addEventListener('click', findAndDisplayPrinciples);
        populateDropdowns();
    </script>

</body>
</html>
